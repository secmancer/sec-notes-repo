### Post-Exploitation Stage Overview
- **Goal**: After gaining initial access during **Exploitation**, the **Post-Exploitation** stage focuses on gathering sensitive data, escalating privileges, and possibly maintaining access. This often requires **higher privileges** than a standard user to retrieve **business-relevant information**.
  
- **Challenges**: At this stage, performing **Evasive Testing** becomes more difficult, as the system may have **heightened security** and monitoring. Decisions on evasive measures should be carefully considered.

### Key Components of Post-Exploitation

1. **Evasive Testing**:
   - Involves continuing to evade detection while operating **within** the compromised system.
   - The risk of triggering alerts increases because you're now **inside** the target environment, which often has more robust monitoring mechanisms.
   - Consider the **necessity** and **risks** of evasive techniques based on the situation and security setup of the target system.

2. **Information Gathering**:
   - Collecting **local-sensitive information** such as:
     - Configuration files
     - Credentials
     - Logs
     - System architecture details
   - Key for understanding the internal workings of the compromised system and identifying further exploitation opportunities.
   
3. **Pillaging**:
   - Systematically extracting **sensitive data**, including:
     - Financial records
     - Intellectual property
     - Client information
   - Targets data that holds value to the organization and may serve as evidence of the compromise.

4. **Vulnerability Assessment**:
   - Similar to the pre-exploitation phase, conducting a local **vulnerability scan** can reveal new vulnerabilities or **misconfigurations** from an insider's perspective.
   - Can assist in identifying **privilege escalation** opportunities or deeper **system weaknesses**.

5. **Privilege Escalation**:
   - **Elevating user privileges** to access restricted areas or execute privileged commands.
   - Common techniques:
     - Exploiting kernel vulnerabilities
     - Leveraging weak or misconfigured services
     - Searching for unprotected credentials or misconfigured SUID files
   - Crucial for gaining full system control and accessing **critical business information**.

6. **Persistence**:
   - Maintaining long-term access to the system even after the exploit vector is patched or detected.
   - Techniques include:
     - Installing **backdoors**
     - Modifying system **startup scripts**
     - Creating new **privileged user accounts**
   - Helps ensure **continued access** for further exploitation or data exfiltration.

7. **Data Exfiltration**:
   - The process of **extracting valuable data** from the compromised system without detection.
   - Techniques can include:
     - Encrypting data before transfer
     - Using **covert channels** (e.g., DNS tunneling) to avoid detection.
   - Must balance speed of exfiltration with **stealth**, as large or noticeable data transfers may trigger alerts.

### Decision-Making in Post-Exploitation
- **Risk Assessment**: Similar to the **Exploitation stage**, you need to continuously evaluate the **risk** of detection versus the **value** of the information or access you are attempting to gain.
- **Communication**: If there is a high risk of detection or system disruption, consult the **client** to ensure they are aware of the potential impact before proceeding with further actions, especially in critical environments.

![[0-PT-Process-POEX_png 1.png]]

### Evasive Testing in Post-Exploitation

- **Risk of Detection**: Skilled administrators or security systems (e.g., EDR) can detect even minor changes or commands, potentially leading to:
  - **Kicked out of the network**
  - **Quarantined hosts** or **disabled user accounts**
  - **Initiation of threat hunting** against the tester.
  
- **Learning from Detection**: Although detection may mean a failed stealth attempt, it can still provide value to the client by:
  - **Documenting the attack chain** and identifying **gaps** in their monitoring and response processes.
  - Offering an opportunity for the tester to study **why** and **how** detection occurred, improving future evasion skills.

- **Purpose of Evasive Testing**: The goal is to identify **blind spots** in the client’s network by performing actions that go mostly undetected. However, **not all detection** is negative, as it shows which security defenses are working.

### Categories of Evasive Testing
1. **Evasive**: Focuses on avoiding detection by security systems.
2. **Hybrid-Evasive**: Targets specific components or systems as defined by the client, testing both detection and response capabilities.
3. **Non-Evasive**: Focuses on extensive testing without concern for detection, often for **intrusive tests** where gathering as much information as possible is the priority.

- **Combining Methods**: All three testing categories can be used together, depending on the **client’s goals** and the **testing scope**.

---

### Information Gathering in Post-Exploitation

- **New Environment**: After gaining access, testers are now inside the target system, requiring **re-acquaintance** with the environment. This includes revisiting the **Information Gathering** and **Vulnerability Assessment** stages from an **internal perspective**.
  
- **Internal Reconnaissance**: New information can be accessed, such as:
  - **Local network** details (e.g., printers, database servers, shares).
  - **Internal services** and user data not visible from an external attack.

---

### Pillaging

- **Purpose**: Investigating the role of the exploited host in the corporate network. Focuses on gathering **sensitive data** and analyzing system configurations.
  
- **Targets**:
  - **Network configurations** (e.g., interfaces, routing, DNS, ARP).
  - **Local services** (e.g., VPN, shares, network traffic).
  - **Sensitive files** (e.g., passwords, scripts, configuration files, email, documents).
  
- **Key Outcomes**:
  - Gaining an understanding of how the system communicates with the broader network.
  - Finding **additional credentials** or **SSH keys** that can be used for **lateral movement** or **persistence**.
  - Identifying **password policies** or **system policies** that can hint at weaknesses in the security setup.

---

### Persistence

- **Purpose**: Ensuring continued access to the system if the connection is lost or interrupted.
  
- **Importance**: Particularly critical in cases where the exploit may be unstable (e.g., buffer overflow). **Establish persistence** early to avoid losing access.
  
- **Methods**:
  - Installing **backdoors** or modifying **startup scripts**.
  - Creating **new user accounts** with **elevated privileges**.
  
- **Flexible Approach**: Persistence strategies vary based on the specific configuration and environment of the compromised system.

---

### Vulnerability Assessment (Post-Exploitation)

- **Internal Vulnerability Assessment**: After gaining access, repeat the **Vulnerability Assessment** process, but this time from an **insider’s perspective**.
  
- **Focus**: Identifying new vulnerabilities or misconfigurations that can be exploited for further access or privilege escalation.
  
- **Risk Management**: Weigh the risks of each exploit carefully to avoid **system disruption** while conducting the assessment.

---

### Privilege Escalation

- **Criticality**: Privilege escalation is one of the most important phases in post-exploitation, enabling greater control and deeper access to the system.
  
- **Goals**: Achieve **root privileges** (on Linux systems) or **domain administrator**/ **SYSTEM** privileges (on Windows systems).
  
- **Methods**:
  - **Local exploits** targeting misconfigurations or weak services.
  - **Credential harvesting** from users with **higher privileges**.
  
- **Broader Network Access**: Higher privileges allow for **unrestricted movement** throughout the network, often leading to complete control over the system.

---

### Data Exfiltration

- **Objective**: Transfer sensitive data from the compromised system without detection.
  
- **Challenges**:
  - Security systems like **Data Loss Prevention (DLP)** and **Endpoint Detection and Response (EDR)** actively monitor for unauthorized data transfers.
  - Network monitoring tools and encrypted hard drives are often in place to prevent unauthorized access to data.
  
- **Precautions**: Before exfiltrating real data, check with the client. **Simulated data** (e.g., fake credit card numbers) can be used to test detection systems without the risk of handling sensitive data.
  
- **Compliance & Regulations**: Different types of data are protected by specific regulations, including:
  - **PCI** for credit card data.
  - **HIPAA** for health information.
  - **GLBA** for banking information.
  - **FISMA** for government information.
  
- **Documentation**: Always maintain **screen recordings** or **screenshots** to document successful exfiltration and the process followed.

---

### Regulatory Frameworks

- Common **security frameworks** organizations may follow include:
  - **NIST** (National Institute of Standards and Technology)
  - **CIS Controls** (Center for Internet Security Controls)
  - **ISO** (International Organization for Standardization)
  - **PCI-DSS** (Payment Card Industry Data Security Standard)
  - **GDPR** (General Data Protection Regulation)
  - **FedRAMP** (Federal Risk and Authorization Management Program)

- **Importance**: Understanding these frameworks helps ensure that security controls meet the required standards for **handling sensitive data** and **protecting client information**.

## Questions
- How many types of evasive testing are mentioned in this section?
	- 3
- What is the name of the security standard for credit card payments that a company must adhere to? (Answer Format: acronym)
	- PCI-DSS