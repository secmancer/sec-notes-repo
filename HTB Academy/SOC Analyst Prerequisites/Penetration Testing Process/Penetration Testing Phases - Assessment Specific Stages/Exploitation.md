During the `Exploitation` stage, we look for ways that these weaknesses can be adapted to our use case to obtain the desired role (i.e., a foothold, escalated privileges, etc.). If we want to get a reverse shell, we need to modify the PoC to execute the code, so the target system connects back to us over (ideally) an encrypted connection to an IP address we specify. Therefore, the preparation of an exploit is mainly part of the `Exploitation` stage.

![[0-PT-Process-EX_png 1.png]]

### Connected Stages in Penetration Testing
- **Integration of Stages**: Stages in penetration testing are **closely connected** and should not be strictly separated. However, it is essential to **distinguish phases** for clarity, especially in complex, long-term projects.
- **Tracking Progress**: As tests can last **weeks** and cover a **large scope**, maintaining a clear record of each stage prevents losing track of the steps already taken.

### Prioritization of Possible Attacks
- After identifying vulnerabilities during the **Vulnerability Assessment** stage, prioritize potential attacks based on three main factors:
  1. **Probability of Success**: Likelihood of successfully exploiting a vulnerability.
  2. **Complexity**: The effort and research required to execute the attack.
  3. **Probability of Damage**: Potential risk of causing harm to the target system.

#### Tools for Prioritization
- **CVSS Scoring**: Use the **NVD calculator** to assess the probability of success for specific attacks.
- **Personal Point System**: A custom evaluation method to prioritize attacks based on expertise and familiarity with the exploit.

#### Prioritization Example (Scoring System)
| **Factor**               | **Points** | **Remote File Inclusion** | **Buffer Overflow** |
|--------------------------|------------|----------------------------|---------------------|
| **Probability of Success**| 10         | 10                         | 8                   |
| **Complexity - Easy**     | 5          | 4                          | 0                   |
| **Complexity - Medium**   | 3          | 0                          | 3                   |
| **Complexity - Hard**     | 1          | 0                          | 0                   |
| **Probability of Damage** | -5         | 0                          | -5                  |
| **Summary**               | max. 15    | 14                         | 6                   |

- **Result**: Remote File Inclusion is prioritized because it is **easier to execute** and has a **lower risk** of causing damage.

### Preparation for the Attack
- **Custom Exploits**: In some cases, existing **PoC exploit code** may not be available, requiring local **reconstruction** of the exploit on a VM representing the target host.
  - Set up the VM with the **same version** numbers of services/applications to **mirror** the target environment.
  - Follow the exploit steps, **test locally**, and ensure no significant damage occurs.
  
- **Common Misconfigurations**: Frequently encountered misconfigurations allow testers to know **which tools** or **exploits** are safe or may cause system instability.

### Client Communication & Risk Management
- **Client Approval**: Always confirm with the client if unsure about running a potentially risky exploit.
  - Provide them with necessary data and let them decide whether to proceed with exploitation or just mark it as a vulnerability.
  
- **Documentation**: If exploitation is not approved, record it in the report as a finding that was **not actively confirmed** but **likely** an issue.
  
- **Risk Management**: Use **best judgment** when considering risky attacks. If in doubt, prioritize **communication** over risking a failed exploit attempt that could disrupt services.

### Post-Exploitation Phase
- After successfully exploiting the target and gaining **initial access**:
  - Ensure clear **documentation** of all activities for the final report.
  - Move on to **post-exploitation** tasks, which may include **lateral movement** to expand access within the system.